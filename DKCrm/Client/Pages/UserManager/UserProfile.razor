@page "/userprofile"

<MudText Typo="Typo.h4" Style="margin: 1rem 0 0 1rem;">Профиль пользователя</MudText>
@if (User != null)
{
    <MudCard>
        <MudForm Model="@User" @ref="@UserProfileForm" Validation="@(_applicationUserValidator.ValidateValue)" ValidationDelay="0">
            <MudCardContent>
                <MudTextField @bind-Value="User.UserName"
                              For="@(() => User.UserName)"
                              Immediate="true"
                              Label="Ник" Required="true"/>

                <MudTextField @bind-Value="User.Email"
                              For="@(() => User.Email)"
                              Immediate="true"
                              Label="Email" Required="true" />

                <MudTextField @bind-Value="User.FirstName"
                              For="@(() => User.FirstName)"
                              Immediate="true"
                              Label="Имя" Required="true" />

                <MudTextField @bind-Value="User.LastName"
                              For="@(() => User.LastName)"
                              Immediate="true"
                              Label="Фамилия" Required="true" />

                <MudTextField @bind-Value="User.PhoneNumber"
                              For="@(() => User.PhoneNumber)"
                              Immediate="true"
                              Label="Телефонный номер" Required="true" />

                <MudTextField @bind-Value="User.AdditionalPhoneNumber"
                              For="@(() => User.AdditionalPhoneNumber)"
                              Immediate="true"
                              Label="Дополнительный телефонный номер"/>


                @if (User.Address != null)
                {
                    <p class="mt-6 fs-4">Основной адрес</p>
                    <MudTextField @bind-Value="User.Address.Country"
                                  For="@(() => User.Address.Country)"
                                  Immediate="true"
                                  Label="Страна"/>

                    <MudTextField @bind-Value="User.Address.City"
                                  For="@(() => User.Address.City)"
                                  Immediate="true"
                                  Label="Город"/>

                    <MudTextField @bind-Value="User.Address.Street"
                                  For="@(() => User.Address.Street)"
                                  Immediate="true"
                                  Label="Улица"/>

                    <MudTextField @bind-Value="User.Address.Home"
                                  For="@(() => User.Address.Home)"
                                  Immediate="true"
                                  Label="Дом/Сторение"/>

                    <MudTextField @bind-Value="User.Address.Placement"
                                  For="@(() => User.Address.Placement)"
                                  Immediate="true"
                                  Label="Помещение/Квартира"/>

                    <MudTextField @bind-Value="User.Address.PostalCode"
                                  For="@(() => User.Address.PostalCode)"
                                  Immediate="true"
                                  Label="Почтовый код"/>
                }
                else
                {
                    <MudButton Variant="Variant.Filled" Size="Size.Medium" OnClick="() => User.Address = new Address()" Style="margin-top: 2rem;" Color="Color.Tertiary">
                        Добавить основной адрес
                        <MudIcon Size="@Size.Medium" Color="Color.Default" Icon="@Icons.Material.Sharp.Add" Class="pa-0 ml-2"/>
                    </MudButton>

                    <br/>
                }
                @if (User.AdditionalAddress != null)
                {
                    <p class="mt-6 fs-4">Дополнительный адрес</p>
                    <MudTextField @bind-Value="User.AdditionalAddress.Country"
                                  For="@(() => User.AdditionalAddress.Country)"
                                  Immediate="true"
                                  Label="Страна"/>

                    <MudTextField @bind-Value="User.AdditionalAddress.City"
                                  For="@(() => User.AdditionalAddress.City)"
                                  Immediate="true"
                                  Label="Город"/>

                    <MudTextField @bind-Value="User.AdditionalAddress.Street"
                                  For="@(() => User.AdditionalAddress.Street)"
                                  Immediate="true"
                                  Label="Улица"/>

                    <MudTextField @bind-Value="User.AdditionalAddress.Home"
                                  For="@(() => User.AdditionalAddress.Home)"
                                  Immediate="true"
                                  Label="Дом/Сторение"/>

                    <MudTextField @bind-Value="User.AdditionalAddress.Placement"
                                  For="@(() => User.AdditionalAddress.Placement)"
                                  Immediate="true"
                                  Label="Помещение/Квартира"/>

                    <MudTextField @bind-Value="User.AdditionalAddress.PostalCode"
                                  For="@(() => User.AdditionalAddress.PostalCode)"
                                  Immediate="true"
                                  Label="Почтовый код"/>
                }
                else
                {
                    <MudButton Variant="Variant.Filled" Size="Size.Medium" OnClick="() => User.AdditionalAddress = new Address()" Style="margin-top: 2rem;" Color="Color.Tertiary">
                        Добавить дополнительный адрес
                        <MudIcon Size="@Size.Medium" Color="Color.Default" Icon="@Icons.Material.Sharp.Add" Class="pa-0 ml-2"/>
                    </MudButton>
                }
            </MudCardContent>
        </MudForm>
        <MudCardActions>
            <MudButton Variant="Variant.Filled" Color="Color.Primary" Class="ml-auto" OnClick="@(async () => await Submit())">Применить</MudButton>
        </MudCardActions>
    </MudCard>
}